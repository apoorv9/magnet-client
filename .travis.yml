language: objective-c
before_cache:
    - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
    directories:
        - $HOME/.gradle/caches/
        - $HOME/.gradle/wrapper/
        - node_modules/
env:
    - BUILD_TYPE=android ARTIFACT=android/app/build/outputs/apk/app-release-unsigned.apk
# Be a good travis citizen while we don't actually run the build on iOS yet.
#    - BUILD_TYPE=ios
before_install:
#    - brew update
#   - git clone https://github.com/creationix/nvm.git /tmp/.nvm
#   - source /tmp/.nvm/nvm.sh
#   - nvm install 5.0
#   - nvm use --delete-prefix 5.0
#   - node --version && npm --version
install:
# Skip the bootstrap an install for testing
#    - . build-scripts/bootstrap.sh
script:
# Skip the build fo testing
#    - ./build-scripts/build.sh
    - mkdir -p `dirname $ARTIFACT`
    - touch $ARTIFACT
    - env
deploy:
    provider: releases
    api_key: $GITHUB_AUTH_TOKEN
    file: $ARTIFACT
    skip_cleanup: true
    overwrite: true
    on:
        tags: true
        # Only deploy if a nightly build or a release (semver tag)
        condition: $TRAVIS_TAG = "nightly-android" || $TRAVIS_TAG = "nightly-ios" || $TRAVIS_TAG =~ ^[0-9]+\.[0-9]+\.[0-9]
